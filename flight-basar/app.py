from flask import Flask, render_template, jsonify
from util.api import call_flight_api, filter_necessary_infos
app = Flask(__name__)


@app.get("/")
def index():
    return render_template("index.html")

@app.get("/flights/<departure_destination>/<arrival_destination>")
def get_flights(departure_destination, arrival_destination):
    #flights = filter_necessary_infos("[{'flight_date': '2025-12-21', 'flight_status': 'landed', 'departure': {'airport': 'Zurich', 'timezone': 'Europe/Zurich', 'iata': 'ZRH', 'icao': 'LSZH', 'terminal': None, 'gate': 'D41', 'delay': None, 'scheduled': '2025-12-21T17:30:00+00:00', 'estimated': '2025-12-21T17:30:00+00:00', 'actual': '2025-12-21T17:56:00+00:00', 'estimated_runway': '2025-12-21T17:56:00+00:00', 'actual_runway': '2025-12-21T17:56:00+00:00'}, 'arrival': {'airport': 'Edinburgh', 'timezone': 'Europe/London', 'iata': 'EDI', 'icao': 'EGPH', 'terminal': '1', 'gate': None, 'baggage': '7', 'scheduled': '2025-12-21T18:55:00+00:00', 'delay': None, 'estimated': '2025-12-21T18:44:00+00:00', 'actual': '2025-12-21T18:44:00+00:00', 'estimated_runway': '2025-12-21T18:44:00+00:00', 'actual_runway': '2025-12-21T18:44:00+00:00'}, 'airline': {'name': 'SWISS', 'iata': 'LX', 'icao': 'SWR'}, 'flight': {'number': '8290', 'iata': 'LX8290', 'icao': 'SWR8290', 'codeshared': {'airline_name': 'edelweiss air', 'airline_iata': 'wk', 'airline_icao': 'edw', 'flight_number': '290', 'flight_iata': 'wk290', 'flight_icao': 'edw290'}}, 'aircraft': {'registration': None, 'iata': None, 'icao': None, 'icao24': '4B18B9'}, 'live': None}, {'flight_date': '2025-12-21', 'flight_status': 'landed', 'departure': {'airport': 'Zurich', 'timezone': 'Europe/Zurich', 'iata': 'ZRH', 'icao': 'LSZH', 'terminal': None, 'gate': 'D41', 'delay': None, 'scheduled': '2025-12-21T17:30:00+00:00', 'estimated': '2025-12-21T17:30:00+00:00', 'actual': '2025-12-21T17:56:00+00:00', 'estimated_runway': '2025-12-21T17:56:00+00:00', 'actual_runway': '2025-12-21T17:56:00+00:00'}, 'arrival': {'airport': 'Edinburgh', 'timezone': 'Europe/London', 'iata': 'EDI', 'icao': 'EGPH', 'terminal': '1', 'gate': None, 'baggage': '7', 'scheduled': '2025-12-21T18:55:00+00:00', 'delay': None, 'estimated': '2025-12-21T18:44:00+00:00', 'actual': '2025-12-21T18:44:00+00:00', 'estimated_runway': '2025-12-21T18:44:00+00:00', 'actual_runway': '2025-12-21T18:44:00+00:00'}, 'airline': {'name': 'Edelweiss Air', 'iata': 'WK', 'icao': 'EDW'}, 'flight': {'number': '290', 'iata': 'WK290', 'icao': 'EDW290', 'codeshared': None}, 'aircraft': {'registration': None, 'iata': None, 'icao': None, 'icao24': '4B18B9'}, 'live': None}, {'flight_date': '2025-12-20', 'flight_status': 'landed', 'departure': {'airport': 'Zurich', 'timezone': 'Europe/Zurich', 'iata': 'ZRH', 'icao': 'LSZH', 'terminal': None, 'gate': 'D43', 'delay': None, 'scheduled': '2025-12-20T18:30:00+00:00', 'estimated': '2025-12-20T18:30:00+00:00', 'actual': '2025-12-20T18:42:00+00:00', 'estimated_runway': '2025-12-20T18:42:00+00:00', 'actual_runway': '2025-12-20T18:42:00+00:00'}, 'arrival': {'airport': 'Edinburgh', 'timezone': 'Europe/London', 'iata': 'EDI', 'icao': 'EGPH', 'terminal': None, 'gate': None, 'baggage': '7', 'scheduled': '2025-12-20T19:55:00+00:00', 'delay': None, 'estimated': '2025-12-20T19:29:00+00:00', 'actual': '2025-12-20T19:27:00+00:00', 'estimated_runway': '2025-12-20T19:27:00+00:00', 'actual_runway': '2025-12-20T19:27:00+00:00'}, 'airline': {'name': 'SWISS', 'iata': 'LX', 'icao': 'SWR'}, 'flight': {'number': '8290', 'iata': 'LX8290', 'icao': 'SWR8290', 'codeshared': {'airline_name': 'edelweiss air', 'airline_iata': 'wk', 'airline_icao': 'edw', 'flight_number': '290', 'flight_iata': 'wk290', 'flight_icao': 'edw290'}}, 'aircraft': {'registration': None, 'iata': None, 'icao': None, 'icao24': '4B18F4'}, 'live': None}, {'flight_date': '2025-12-20', 'flight_status': 'landed', 'departure': {'airport': 'Zurich', 'timezone': 'Europe/Zurich', 'iata': 'ZRH', 'icao': 'LSZH', 'terminal': None, 'gate': 'D43', 'delay': None, 'scheduled': '2025-12-20T18:30:00+00:00', 'estimated': '2025-12-20T18:30:00+00:00', 'actual': '2025-12-20T18:42:00+00:00', 'estimated_runway': '2025-12-20T18:42:00+00:00', 'actual_runway': '2025-12-20T18:42:00+00:00'}, 'arrival': {'airport': 'Edinburgh', 'timezone': 'Europe/London', 'iata': 'EDI', 'icao': 'EGPH', 'terminal': None, 'gate': None, 'baggage': '7', 'scheduled': '2025-12-20T19:55:00+00:00', 'delay': None, 'estimated': '2025-12-20T19:29:00+00:00', 'actual': '2025-12-20T19:27:00+00:00', 'estimated_runway': '2025-12-20T19:27:00+00:00', 'actual_runway': '2025-12-20T19:27:00+00:00'}, 'airline': {'name': 'Edelweiss Air', 'iata': 'WK', 'icao': 'EDW'}, 'flight': {'number': '290', 'iata': 'WK290', 'icao': 'EDW290', 'codeshared': None}, 'aircraft': {'registration': None, 'iata': None, 'icao': None, 'icao24': '4B18F4'}, 'live': None}, {'flight_date': '2025-12-20', 'flight_status': 'landed', 'departure': {'airport': 'Zurich', 'timezone': 'Europe/Zurich', 'iata': 'ZRH', 'icao': 'LSZH', 'terminal': None, 'gate': '3', 'delay': 42, 'scheduled': '2025-12-20T10:05:00+00:00', 'estimated': '2025-12-20T10:05:00+00:00', 'actual': '2025-12-20T11:13:00+00:00', 'estimated_runway': '2025-12-20T11:13:00+00:00', 'actual_runway': '2025-12-20T11:13:00+00:00'}, 'arrival': {'airport': 'Edinburgh', 'timezone': 'Europe/London', 'iata': 'EDI', 'icao': 'EGPH', 'terminal': '1', 'gate': None, 'baggage': '7', 'scheduled': '2025-12-20T11:25:00+00:00', 'delay': 42, 'estimated': '2025-12-20T12:05:00+00:00', 'actual': '2025-12-20T12:07:00+00:00', 'estimated_runway': '2025-12-20T12:07:00+00:00', 'actual_runway': '2025-12-20T12:07:00+00:00'}, 'airline': {'name': 'easyJet', 'iata': 'U2', 'icao': 'EZY'}, 'flight': {'number': '3298', 'iata': 'U23298', 'icao': 'EZY3298', 'codeshared': None}, 'aircraft': {'registration': None, 'iata': None, 'icao': None, 'icao24': '406012'}, 'live': None}]")
    # flights = call_flight_api(departure_destination, arrival_destination, 10)
    flights = "[{\"from\":\"John F Kennedy International\",\"to\":\"Frankfurt International Airport\",\"airline\":\"Thai Airways International\",\"flight\":\"TG7723\",\"departureTime\":\"22:00\",\"arrivalTime\":\"11:40\",\"flightDate\":\"2026-01-06\"},{\"from\":\"John F Kennedy International\",\"to\":\"Frankfurt International Airport\",\"airline\":\"Brussels Airlines\",\"flight\":\"SN7233\",\"departureTime\":\"22:00\",\"arrivalTime\":\"11:40\",\"flightDate\":\"2026-01-06\"},{\"from\":\"John F Kennedy International\",\"to\":\"Frankfurt International Airport\",\"airline\":\"Air New Zealand\",\"flight\":\"NZ4225\",\"departureTime\":\"22:00\",\"arrivalTime\":\"11:40\",\"flightDate\":\"2026-01-06\"},{\"from\":\"John F Kennedy International\",\"to\":\"Frankfurt International Airport\",\"airline\":\"Ethiopian Airlines\",\"flight\":\"ET1617\",\"departureTime\":\"22:00\",\"arrivalTime\":\"11:40\",\"flightDate\":\"2026-01-06\"},{\"from\":\"John F Kennedy International\",\"to\":\"Frankfurt International Airport\",\"airline\":\"United Airlines\",\"flight\":\"UA8842\",\"departureTime\":\"22:00\",\"arrivalTime\":\"11:40\",\"flightDate\":\"2026-01-06\"},{\"from\":\"John F Kennedy International\",\"to\":\"Frankfurt International Airport\",\"airline\":\"Virgin Atlantic\",\"flight\":\"VS3810\",\"departureTime\":\"18:10\",\"arrivalTime\":\"07:50\",\"flightDate\":\"2026-01-06\"},{\"from\":\"John F Kennedy International\",\"to\":\"Frankfurt International Airport\",\"airline\":\"Vietnam Airlines\",\"flight\":\"VN3062\",\"departureTime\":\"18:10\",\"arrivalTime\":\"07:50\",\"flightDate\":\"2026-01-06\"},{\"from\":\"John F Kennedy International\",\"to\":\"Frankfurt International Airport\",\"airline\":\"Air France\",\"flight\":\"AF3647\",\"departureTime\":\"18:10\",\"arrivalTime\":\"07:50\",\"flightDate\":\"2026-01-06\"},{\"from\":\"John F Kennedy International\",\"to\":\"Frankfurt International Airport\",\"airline\":\"KLM\",\"flight\":\"KL6106\",\"departureTime\":\"18:10\",\"arrivalTime\":\"07:50\",\"flightDate\":\"2026-01-06\"},{\"from\":\"John F Kennedy International\",\"to\":\"Frankfurt International Airport\",\"airline\":\"Brussels Airlines\",\"flight\":\"SN7231\",\"departureTime\":\"15:55\",\"arrivalTime\":\"05:30\",\"flightDate\":\"2026-01-06\"}]"
    print(departure_destination, arrival_destination)
    print(flights)
    return flights

if __name__ == "__main__":
    app.run(debug=True)
